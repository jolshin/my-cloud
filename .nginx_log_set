# Основной контекст http
http {
        ##
        # Logging Settings
        ##

        # Custom log formats
        
         log_format main_ext '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for" '
                      '"$host" sn="$server_name" '
                      'rt=$request_time '
                      'ua="$upstream_addr" us="$upstream_status" '
                      'ut="$upstream_response_time" ul="$upstream_response_length" '
                      'cs=$upstream_cache_status';


        
        log_format debug_ext '$time_local [DEBUG] $remote_addr "$request" '
                       'rt=$request_time pid=$pid tid=$connection';
        
        
        log_format info_ext '$time_local [INFO] "$request" $status '
                      'rt=$request_time bytes=$body_bytes_sent';

        

        log_format warning_ext '$time_local [WARNING] "$request" $status '
                         'client=$remote_addr ref="$http_referer"';


        log_format error_ext '$time_local [ERROR] "$request" $status '
                       'error=$request_completion client=$remote_addr '
                       'upstream_error=$upstream_status';       

        # Debug condition

        map $http_x_debug $debug_condition {
                default 0;
                '1'     1;
        }

        access_log /var/log/nginx/access.log;
        
        error_log /dev/stderr debug;
        access_log /dev/stdout main_ext;
        
        # Additional logs

        access_log /dev/stdout debug_ext if=$debug_condition;
        access_log /dev/stdout info_ext;
        access_log /dev/stderr warning_ext;
        access_log /dev/stderr error_ext;
}